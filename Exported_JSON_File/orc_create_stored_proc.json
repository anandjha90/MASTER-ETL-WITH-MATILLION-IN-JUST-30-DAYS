{"dbEnvironment":"snowflake","version":"1.75.0","jobsTree":{"id":2926,"name":"ROOT","children":[{"id":3855,"name":"practice_matillion","children":[],"jobs":[{"id":10150,"name":"orc_create_stored_proc","description":"","type":"ORCHESTRATION","tag":"8c6881a7-1698-4cab-9368-30e470457353"}]}],"jobs":[]},"orchestrationJobs":[{"id":10150,"revision":48,"created":1721249749129,"timestamp":1721249749129,"components":{"10101":{"id":10101,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-560,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[10109],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"10106":{"id":10106,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-384,"y":-128,"width":32,"height":32,"inputConnectorIDs":[10109],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[10494,10767],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"created stored proc"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATE OR REPLACE PROCEDURE actiontobeperformed(src_db STRING,\n\t\t\t\t\t\t\t\t\t\t\t\tsrc_dbschema string,\n\t\t\t\t\t\t\t\t\t\t\t\ttablename string,\n\t\t\t\t\t\t\t\t\t\t\t\ttgt_db string,\n\t\t\t\t\t\t\t\t\t\t\t\ttgt_dbschema string,\n\t\t\t\t\t\t\t\t\t\t\t\taction_type string,\n\t\t\t\t\t\t\t\t\t\t\t\ttable_view char(1))\nreturns string\nlanguage javascript\nexecute as caller\nas\n$$\n\nvar action_type  = ACTION_TYPE;\nvar src_db       = SRC_DB;\nvar src_dbschema = SRC_DBSCHEMA;\nvar tablename    = TABLENAME;\nvar tgt_db       = TGT_DB;\nvar tgt_dbschema = TGT_DBSCHEMA;\nvar table_view   = TABLE_VIEW;\nvar result       = \"\";\n\nvar sql_query_text = \"\";\ntry\n{\n\nif (action_type.toUpperCase() == 'CREATE' && table_view.toUpperCase() == 'T')\n{\nvar sql_query_text = 'CREATE OR REPLACE TABLE ' + tgt_db + '.' + tgt_dbschema + '.' + tablename + ' like ' + src_db +\n'.' + src_dbschema + '.' + tablename + ';'\nsnowflake.createStatement({sqlText:sql_query_text}).execute();\nresult = \"Table created successfully: \" + tgt_db + '.' + tgt_dbschema + '.' + tablename\n}\n\nelse if (action_type.toUpperCase() == 'INSERT' && table_view.toUpperCase() == 'I')\n{\nvar sql_query_text = 'INSERT INTO ' + tgt_db + '.' + tgt_dbschema + '.' + tablename + ' select * from ' + src_db +\n'.' + src_dbschema + '.' + tablename + ';'\nsnowflake.createStatement({sqlText:sql_query_text}).execute();\nresult = \"Insertion successfully completed: \" + tgt_db + '.' + tgt_dbschema + '.' + tablename\n}\nelse\n{\nresult = \"Fail: Please give proper parameter \\n\" + \"1.If INSERTing the data then parameter should be only Table(t/T)\\n\"\n}\n\n}\ncatch (err)\n{\nresult += \"\\n Code: \" + err.code + \"\\n State: \" + err.state;\nresult += \"\\n Message: \" + err.message;\nresult += \"\\n Stack Trace:\\n\" + err.stackTraceTxt;\nresult += \"Failed Query Text: \" +sql_query_text;\nthrow result;\n}\nreturn result;\n$$\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"10491":{"id":10491,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":-128,"width":32,"height":32,"inputConnectorIDs":[10494],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"calling stored proc for table creation in dest schema"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'BROKER','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CATEGORIES','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'COMPLAIN','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CUSTOMER','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRIORITIES','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRODUCT','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'REGION','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'SOURCES','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATE_REGION','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATUSES','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'TYPE','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"10762":{"id":10762,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":-16,"width":32,"height":32,"inputConnectorIDs":[10767],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"calling stored proc for data insertion"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'BROKER','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CATEGORIES','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'COMPLAIN','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CUSTOMER','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRIORITIES','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRODUCT','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'REGION','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'SOURCES','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATE_REGION','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATUSES','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'TYPE','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{},"failureConnectors":{},"unconditionalConnectors":{"10109":{"id":10109,"sourceID":10101,"targetID":10106},"10494":{"id":10494,"sourceID":10106,"targetID":10491},"10767":{"id":10767,"sourceID":10106,"targetID":10762}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":false,"undoCommand":"Rename Job","undoCreated":1721249264554,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{},"variables":{},"grids":{}}],"transformationJobs":[],"variables":[],"environments":[]}