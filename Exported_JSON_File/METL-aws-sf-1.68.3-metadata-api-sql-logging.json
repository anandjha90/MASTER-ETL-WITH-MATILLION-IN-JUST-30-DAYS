{"dbEnvironment":"snowflake","version":"1.68.3","jobsTree":{"id":145,"name":"ROOT","children":[{"id":4743,"name":"matillion-examples","children":[{"id":5404,"name":"Metadata API SQL Logging","children":[],"jobs":[{"id":5426,"name":"Colocate Lineage SQL medatada","description":"Read the SQL executed and save to a permanent table","type":"ORCHESTRATION","tag":"476c537a-e4f6-44b1-8dac-1e525320d378"},{"id":5738,"name":"Load Lineage SQL medatada","description":"Load the new data into the SQL log table by transforming it to fit the target table","type":"TRANSFORMATION","tag":"2d833eee-1469-4fbf-8ea2-62eef51892cf"}]}],"jobs":[]}],"jobs":[]},"orchestrationJobs":[{"id":5426,"revision":109,"created":1698484716487,"timestamp":1698484716487,"components":{"5427":{"id":5427,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-496,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[5442],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5441":{"id":5441,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":-288,"y":0,"width":32,"height":32,"inputConnectorIDs":[5442],"outputSuccessConnectorIDs":[5517],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Log Table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ods_lineage_log"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"log_logged_timestamp"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"Yes"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"log_sql_order"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"5"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"log_start_datetime"},"2":{"slot":2,"type":"STRING","value":"TIMESTAMP"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"log_end_datetime"},"2":{"slot":2,"type":"STRING","value":"TIMESTAMP"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"log_duration_seconds"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"38"},"4":{"slot":4,"type":"INTEGER","value":"0"},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"log_run_type"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"32"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"log_job_path"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"256"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"log_operation_type"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"256"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"log_sql_dialect"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"256"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"log_sql_user"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"256"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"log_sql_endpoint"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"2048"},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"log_raw_sql"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"No"},"7":{"slot":7,"type":"STRING","value":"No"},"8":{"slot":8,"type":"STRING","value":""}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create if not exists"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Permanent"}}}},"visible":true},"13":{"slot":13,"name":"Default DDL Collation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5492":{"id":5492,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-80,"y":0,"width":32,"height":32,"inputConnectorIDs":[5517],"outputSuccessConnectorIDs":[5548],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Find highwater mark"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT CASE WHEN MAX(\"log_logged_timestamp\") IS NULL THEN 1000000 \n            ELSE MAX(\"log_logged_timestamp\") + 1\n       END AS \"log_logged_timestamp\"\nFROM \"ods_lineage_log\""}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"prvt_hwm_timestamp"},"2":{"slot":2,"type":"STRING","value":"log_logged_timestamp"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5547":{"id":5547,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":144,"y":0,"width":32,"height":32,"inputConnectorIDs":[5548],"outputSuccessConnectorIDs":[5743],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"API Extract 0"}}}},"visible":true},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"matillion_metadata_api"}}}},"visible":false},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"lineage"}}}},"visible":true},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"lineage_auth"}}}},"visible":false},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${prvt_api_username}"}}}},"visible":true},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${prvt_api_password}"}}}},"visible":true},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"12":{"slot":12,"name":"URI Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"mtln_environment"},"2":{"slot":2,"type":"STRING","value":"${environment_name}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"mtln_project"},"2":{"slot":2,"type":"STRING","value":"${project_name}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"mtln_group"},"2":{"slot":2,"type":"STRING","value":"${project_group_name}"}}}},"visible":true},"13":{"slot":13,"name":"Query Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"startTimestamp"},"2":{"slot":2,"type":"STRING","value":"${prvt_hwm_timestamp}"}}}},"visible":true},"14":{"slot":14,"name":"Header Params","elements":{},"visible":true},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"matillion_metadata_api"}}}},"visible":true},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s3://${prvt_staging_bucket_name}"}}}},"visible":true},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_lineage_log"}}}},"visible":true},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5742":{"id":5742,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":384,"y":0,"width":32,"height":32,"inputConnectorIDs":[5743],"outputSuccessConnectorIDs":[5943],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Lineage SQL medatada"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Load Lineage SQL medatada"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"5942":{"id":5942,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1291941950,"x":560,"y":0,"width":32,"height":32,"inputConnectorIDs":[5943],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delete Tables 0"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_lineage_log"}}}},"visible":true},"5":{"slot":5,"name":"Ignore Missing","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"5517":{"id":5517,"sourceID":5441,"targetID":5492},"5548":{"id":5548,"sourceID":5492,"targetID":5547},"5743":{"id":5743,"sourceID":5547,"targetID":5742},"5943":{"id":5943,"sourceID":5742,"targetID":5942}},"failureConnectors":{},"unconditionalConnectors":{"5442":{"id":5442,"sourceID":5427,"targetID":5441}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"canUndo":true,"undoCommand":"Set Job Variables","undoCreated":1698484561753,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"5568":{"id":5568,"x":-364,"y":-125,"width":165,"height":199,"text":"Create the SQL log table **ods_lineage_log**.\nIn a medallion data architecture this is a silver layer object, so only create the table if it does not already exist.","colour":"00ce4f"},"5586":{"id":5586,"x":-160,"y":-125,"width":155,"height":199,"text":"Fetch the latest timestamp loaded (the high water mark) into a job variable.\nDefault to a long time in the past if no data has ever been loaded.","colour":"00ce4f"},"5721":{"id":5721,"x":25,"y":-124,"width":246,"height":199,"text":"Extract all the SQL executed above the high water mark, into a new table **tmp_lineage_log**\n\nTo make this component validate and run, supply valid values for all the private job variables.","colour":"00ce4f"},"5936":{"id":5936,"x":296,"y":-124,"width":168,"height":198,"text":"Run the transformation job to transform and copy the data from bronze to its permanent home in the silver layer","colour":"00ce4f"}},"variables":{"prvt_api_password":{"definition":{"name":"prvt_api_password","type":"TEXT","scope":"TASKBATCH","description":"The API user password","visibility":"PRIVATE"},"value":null},"prvt_api_username":{"definition":{"name":"prvt_api_username","type":"TEXT","scope":"TASKBATCH","description":"The API user name","visibility":"PRIVATE"},"value":null},"prvt_hwm_timestamp":{"definition":{"name":"prvt_hwm_timestamp","type":"DECIMAL","scope":"TASKBATCH","description":"The latest timestamp loaded","visibility":"PRIVATE"},"value":null},"prvt_staging_bucket_name":{"definition":{"name":"prvt_staging_bucket_name","type":"TEXT","scope":"TASKBATCH","description":"The name of an S3 bucket used for staging. Do not include the s3:// prefix nor any path","visibility":"PRIVATE"},"value":null}},"grids":{}}],"transformationJobs":[{"id":5738,"revision":55,"created":1698484782035,"timestamp":1698484782035,"components":{"5762":{"id":5762,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":240,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[5788],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_lineage_log"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_lineage_log"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Data Value"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5787":{"id":5787,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":480,"y":320,"width":32,"height":32,"inputConnectorIDs":[5788],"outputConnectorIDs":[5834],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Relationalize"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT INDEX as \"sql_index\",\n       (\"i\".\"Data Value\":\"loggedTimestamp\")::VARCHAR AS \"loggedTimestamp\",\n       (\"i\".\"Data Value\":\"componentCanvasName\")::VARCHAR AS \"componentCanvasName\",\n       (\"i\".\"Data Value\":\"componentName\")::VARCHAR AS \"componentName\",\n       (\"i\".\"Data Value\":\"endTimestamp\")::NUMBER AS \"endTimestamp\",\n       (\"i\".\"Data Value\":\"environment\":\"database\")::VARCHAR AS \"database\",\n       (\"i\".\"Data Value\":\"environment\":\"schema\")::VARCHAR AS \"schema\",\n       (\"i\".\"Data Value\":\"environment\":\"url\")::VARCHAR AS \"url\",\n       (\"i\".\"Data Value\":\"environment\":\"user\")::VARCHAR AS \"user\",\n       (\"i\".\"Data Value\":\"job\":\"name\")::VARCHAR AS \"name\",\n       (\"i\".\"Data Value\":\"job\":\"type\")::VARCHAR AS \"type\",\n       (\"i\".\"Data Value\":\"sourceUsername\")::VARCHAR AS \"sourceUsername\",\n       (\"f1\".Value:\"dialect\")::VARCHAR AS \"dialect\",\n       (\"f1\".Value:\"query\")::VARCHAR AS \"query\",\n       (\"i\".\"Data Value\":\"startTimestamp\")::NUMBER AS \"startTimestamp\",\n       (\"i\".\"Data Value\":\"urlPath\")::VARCHAR AS \"urlPath\",\n       (\"i\".\"Data Value\":\"sourceConnectionUrl\")::VARCHAR AS \"sourceConnectionUrl\",\n       (\"i\".\"Data Value\":\"taskType\")::VARCHAR AS \"taskType\"\nFROM $T{tmp_lineage_log} \"i\",\n     LATERAL FLATTEN (input => \"i\".\"Data Value\":\"sql\") \"f1\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5831":{"id":5831,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":752,"y":320,"width":32,"height":32,"inputConnectorIDs":[5834],"outputConnectorIDs":[5843],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Determine Run Length"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(\"startTimestamp\" / 1000 )"},"2":{"slot":2,"type":"STRING","value":"start_datetime"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(\"endTimestamp\" / 1000 )"},"2":{"slot":2,"type":"STRING","value":"end_datetime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TIMESTAMPDIFF(second, \"start_datetime\" , \"end_datetime\")"},"2":{"slot":2,"type":"STRING","value":"run_duration"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5841":{"id":5841,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":976,"y":320,"width":32,"height":32,"inputConnectorIDs":[5843],"outputConnectorIDs":[5853],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Unify Environment Details"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"case when \"dialect\" = 'Snowflake' then \"url\" else \"sourceConnectionUrl\" end"},"2":{"slot":2,"type":"STRING","value":"target_endpoint"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"case when \"dialect\" = 'Snowflake' then \"user\" else \"sourceUsername\" end"},"2":{"slot":2,"type":"STRING","value":"target_user"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"5852":{"id":5852,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1264,"y":320,"width":32,"height":32,"inputConnectorIDs":[5853],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append to target"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ods_lineage_log"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"loggedTimestamp"},"2":{"slot":2,"type":"STRING","value":"log_logged_timestamp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"start_datetime"},"2":{"slot":2,"type":"STRING","value":"log_start_datetime"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"end_datetime"},"2":{"slot":2,"type":"STRING","value":"log_end_datetime"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"run_duration"},"2":{"slot":2,"type":"STRING","value":"log_duration_seconds"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"type"},"2":{"slot":2,"type":"STRING","value":"log_run_type"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"urlPath"},"2":{"slot":2,"type":"STRING","value":"log_job_path"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"componentName"},"2":{"slot":2,"type":"STRING","value":"log_operation_type"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"dialect"},"2":{"slot":2,"type":"STRING","value":"log_sql_dialect"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"target_endpoint"},"2":{"slot":2,"type":"STRING","value":"log_sql_endpoint"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"target_user"},"2":{"slot":2,"type":"STRING","value":"log_sql_user"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"query"},"2":{"slot":2,"type":"STRING","value":"log_raw_sql"}}},"12":{"slot":12,"values":{"1":{"slot":1,"type":"STRING","value":"sql_index"},"2":{"slot":2,"type":"STRING","value":"log_sql_order"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"log_logged_timestamp"},"2":{"slot":2,"type":"STRING","value":"Ascending"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"5788":{"id":5788,"sourceID":5762,"targetID":5787},"5834":{"id":5834,"sourceID":5787,"targetID":5831},"5843":{"id":5843,"sourceID":5831,"targetID":5841},"5853":{"id":5853,"sourceID":5841,"targetID":5852}},"canUndo":true,"undoCommand":"Resize Note","undoCreated":1698484776256,"canRedo":false,"redoCommand":"","redoCreated":-1,"notes":{"5771":{"id":5771,"x":149,"y":185,"width":151,"height":184,"text":"This transformation job starts with the newly colocated data in its raw (bronze) form","colour":"00ce4f"},"5800":{"id":5800,"x":333,"y":185,"width":312,"height":185,"text":"Change the granularity of the data to 1 row per SQL statement executed - and extract fields to columns\n\nAlso store the INDEX field from the flatten - to preserve the order of the SQL statements in the array (when a single component executes multiple SQL statements, such as an ingestion component)","colour":"00ce4f"},"5756":{"id":5756,"x":188,"y":73,"width":813,"height":67,"text":"In a medallion data architecture this is a bronze-to-silver layer data transformation.\nIt appends data to the silver layer target table **ods_lineage_log** from the bronze layer source table **tmp_lineage_log**.","colour":"00ce4f"},"5848":{"id":5848,"x":673,"y":184,"width":161,"height":185,"text":"Convert the UNIX-style timestamp fields into Snowflake Timestamps, and calculate a duration","colour":"00ce4f"},"5849":{"id":5849,"x":862,"y":183,"width":240,"height":185,"text":"In the Matillion API all query operations log the currently selected Environment (e.g. Snowflake) - including SQL executed against source systems.\n\nThis calculator creates two fields that log the Snowflake username unless a source username is included","colour":"00ce4f"},"6018":{"id":6018,"x":1149,"y":185,"width":207,"height":184,"text":"This is an INSERT-only append. The high watermark loading approach removes the possibilty of duplication.","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}}],"variables":[],"environments":[]}